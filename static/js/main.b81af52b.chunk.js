(this["webpackJsonpsimple-shop"]=this["webpackJsonpsimple-shop"]||[]).push([[0],{44:function(e,n,t){e.exports=t(73)},49:function(e,n,t){},50:function(e,n,t){},73:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(18),i=t.n(c),l=(t(49),t(3)),o=t(14),u=t(5),s=t(4),d=(t(50),t(1)),m=t(7),p=Object(m.c)(),b=p.getInitialState({ids:["products","cart"],entities:{products:{to:"/",className:"active",content:"Product list"},cart:{to:"/cart",className:"",content:"Cart"}},activeId:"products"}),f=Object(m.d)({name:"navigation",initialState:b,reducers:{changeActive:{reducer:function(e,n){var t=n.payload.activeId;t!==e.activeId&&(e.entities[e.activeId].className="",e.entities[t].className="active",e.activeId=t)},prepare:function(e){return{payload:{activeId:e}}}}}}),x=f.actions.changeActive,g=f.reducer,h=p.getSelectors((function(e){return e.navigation})),v=h.selectById,E=h.selectIds,O=t(13),j=Object(m.c)(),y=j.getInitialState({cartCount:0,totalPrice:0}),k=Object(m.d)({name:"cart",initialState:y,reducers:{addToCart:function(e,n){e.cartCount++;var t=n.payload,a=t.id,r=t.price;e.ids.includes(a)?e.entities[a].itemCount++:j.addOne(e,n.payload),e.totalPrice+=r},changeItemCount:{reducer:function(e,n){var t=n.payload,a=t.itemId,r=t.itemCount,c=e.entities[a],i=c.itemCount-r;c.itemCount=r,e.cartCount-=i,e.totalPrice-=c.price*i},prepare:function(e,n){return{payload:{itemId:e,itemCount:n}}}},deleteItem:function(e,n){var t=n.payload,a=e.entities[t];j.removeOne(e,n.payload),e.cartCount-=a.itemCount,e.totalPrice-=a.price*a.itemCount},emptyCart:function(e){j.setAll(e,{}),e.cartCount=0,e.totalPrice=0}}}),C=k.reducer,w=j.getSelectors((function(e){return e.cart})),I=w.selectAll,N=w.selectById,P=w.selectIds,A=k.actions,S=A.addToCart,B=A.changeItemCount,z=A.deleteItem,T=A.emptyCart,V=(Object(O.a)([I],(function(e){return e.map((function(e){return e.itemCount}))})),Object(O.a)([function(e){return e.cart.cartCount}],(function(e){return e}))),M=Object(O.a)([function(e){return e.cart.totalPrice}],(function(e){return e}));function $(){var e=Object(l.a)(["\n  display: flex;\n  justify-content: space-between;\n\n  padding: 10px 50px 10px 50px;\n\n  border-bottom: 2px solid black;\n\n  h1 {\n    font-size: 30px;\n  }\n\n  .header-right {\n    display: flex;\n    align-items: center;\n\n    button {\n      margin-right: 40px;\n\n      height: 30px;\n      width: 120px;\n\n      border-radius: 2px;\n      border: 1px solid black;\n\n      font-size: inherit;\n    }\n\n    h2 {\n      width: 100px;\n      font-weight: normal;\n    }\n  }\n"]);return $=function(){return e},e}var L=s.a.header($()),J=function(){var e=Object(u.h)(),n=Object(d.b)(),t=Object(d.c)((function(e){return V(e)})),c=Object(a.useCallback)((function(e){e.target.id&&["products","cart"].includes(e.target.id)&&n(x(e.target.id))}),[n]),i=Object(a.useCallback)((function(){return"/summary"===e.pathname?0:t}),[e.pathname,t]);return r.a.createElement(L,{onClick:c},r.a.createElement("h1",null,r.a.createElement(o.b,{id:"products",to:"/"},"My simple shop")),r.a.createElement("div",{className:"header-right"},r.a.createElement("button",{onClick:function(){return document.getElementById("modal").showModal()}},"new product"),r.a.createElement(o.b,{id:"cart",to:"/cart"},r.a.createElement("h2",null,"Cart ",i()))))};function W(){var e=Object(l.a)(["\n  display: flex;\n  margin-bottom: 3px;\n\n  a {\n    padding: 1px 0;\n    width: 100%;\n    height: 100%;\n  }\n"]);return W=function(){return e},e}var F=s.a.div(W()),R=function(e){var n=e.linkId,t=Object(d.c)((function(e){return v(e,n)}));return r.a.createElement(F,{className:t.className},r.a.createElement(o.b,{id:n,to:t.to},t.content))};function U(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-shrink: 0;\n\n  padding-top: 20px;\n\n  width: 200px;\n\n  font-size: 18px;\n  line-height: 1.4em;\n  text-align: center;\n\n  border-right: 2px solid black;\n\n  .active {\n    box-shadow: 0 0 0 1px black;\n    background-color: #e9e9e9;\n  }\n"]);return U=function(){return e},e}var Y,q=s.a.nav(U()),D=function(){var e=Object(d.b)(),n=Object(u.g)(),t=Object(d.c)(E);Object(a.useEffect)((function(){n.push("/")}));var c=Object(a.useCallback)(t.map((function(e){return r.a.createElement(R,{key:e,linkId:e})})),[t]),i=Object(a.useCallback)((function(n){"A"===n.target.tagName&&e(x(n.target.id))}),[e]);return r.a.createElement(q,{onClick:i},c)},G=t(19),H=t(20),K=t(25),Q=t.n(K),X=t(42),Z=t(43),_=t.n(Z),ee=Object(m.b)("products/fetchProducts",Object(X.a)(Q.a.mark((function e(){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.get("".concat("/simple-shop","/products.json"));case 2:return n=e.sent,e.abrupt("return",Object.values(n.data).map((function(e){return e.id=Object(m.e)(),e})));case 4:case"end":return e.stop()}}),e)})))),ne=Object(m.c)({sortComparer:function(e,n){return e.name.localeCompare(n.name)}}),te=ne.getInitialState({status:"idle",error:null,sortBy:"name",isAscending:!0,isOutVisible:!1}),ae=Object(m.d)({name:"products",initialState:te,reducers:{addProduct:{reducer:ne.addOne,prepare:function(e,n,t){return{payload:{id:Object(m.e)(),name:e,price:n,available:t}}}},changeSortBy:{reducer:function(e,n){var t=n.payload.sortBy;e.sortBy=t},prepare:function(e){return{payload:{sortBy:e}}}},changeIsAscending:{reducer:function(e,n){var t=n.payload.isAscending;e.isAscending=t},prepare:function(e){return{payload:{isAscending:e}}}},sortProducts:function(e){var n;switch(e.sortBy){case"name":n=function(e,n){return e.name.localeCompare(n.name)};break;case"price":n=function(e,n){return+e.price-+n.price};break;case"availability":n=function(e,n){return+e.available-+n.available}}var t=function(t,a){return n(e.entities[t],e.entities[a])},a=e.isAscending?function(e,n){return t(e,n)}:function(e,n){return t(n,e)};e.ids.sort(a)},reverseOrder:function(e){e.ids.reverse()},changeIsOutVisible:function(e){e.isOutVisible=!e.isOutVisible},buyCart:{reducer:function(e,n){n.payload.forEach((function(n){e.entities[n.id].available-=n.itemCount}))}}},extraReducers:(Y={},Object(H.a)(Y,ee.pending,(function(e){e.status="loading"})),Object(H.a)(Y,ee.fulfilled,(function(e,n){e.status="succeeded",ne.upsertMany(e,n.payload)})),Object(H.a)(Y,ee.rejected,(function(e,n){e.status="failed",e.error=n.error.message})),Y)}),re=ae.actions,ce=re.addProduct,ie=re.buyCart,le=re.changeIsOutVisible,oe=re.sortProducts,ue=re.reverseOrder,se=re.changeSortBy,de=re.changeIsAscending,me=ae.reducer,pe=ne.getSelectors((function(e){return e.products})),be=(pe.selectAll,pe.selectById),fe=pe.selectIds,xe=Object(O.a)([function(e){return e.products.isOutVisible}],(function(e){return e})),ge=Object(O.a)((function(e,n){return be(e,n).available}),(function(e){return e}));function he(){var e=Object(l.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n\n  flex-grow: 1;\n\n  margin-bottom: 20px;\n  padding: 0 10px;\n  height: 40px;\n\n  border: 1px solid #8f8f8f;\n  border-radius: 2px;\n\n  .carrItem-left {\n    display: flex;\n    align-items: center;\n  }\n\n  h4 {\n    padding: 0;\n    margin-right: 10px;\n  }\n\n  input {\n    font-size: inherit;\n    text-align: right;\n\n    width: 50px;\n    margin: 0 20px 0 15px;\n\n    border: 1px solid black;\n    border-radius: 5px;\n\n    &::-webkit-inner-spin-button,\n    &::-webkit-outer-spin-button {\n      opacity: 1;\n    }\n\n    &:focus {\n      outline: transparent;\n    }\n  }\n\n  button {\n    margin: 0 0 2px 15px;\n    padding: 0 3px 1px 3px;\n\n    font-size: 12px;\n\n    border-radius: 15px;\n  }\n"]);return he=function(){return e},e}var ve=s.a.div(he()),Ee=function(e){var n=e.itemId,t=Object(d.b)(),c=Object(d.c)((function(e){return ge(e,n)})),i=Object(d.c)((function(e){return N(e,n)})),l=Object(a.useState)("hidden"),o=Object(G.a)(l,2),u=o[0],s=o[1],m=Object(a.useCallback)((function(e){var a=e.target.value;""!==a?(!a||a<=0?a=1:a>c&&(a=c,s("")),e.target.value=a,t(B(n,a))):e.target.value=""}),[t,n,c]),p=Object(a.useCallback)((function(){t(z(n))}),[t,n]);return Object(a.useEffect)((function(){var e;return i.itemCount===c&&""===u&&(e=setTimeout((function(){s("hidden")}),2e3)),function(){return clearTimeout(e)}}),[i.itemCount,c,u]),r.a.createElement(ve,null,r.a.createElement("div",{className:"carrItem-left"},r.a.createElement("h4",null,i.name),r.a.createElement("span",null,"(",i.price*i.itemCount,"$)")),r.a.createElement("div",null,r.a.createElement("span",{className:u},r.a.createElement("i",null,"no more in stock")),r.a.createElement("input",{type:"number",onInput:m,defaultValue:i.itemCount}),r.a.createElement("button",{onClick:p},"\u2716")))};function Oe(){var e=Object(l.a)(["\n  margin-top: 20px;\n\n  h2 {\n    font-weight: normal;\n    margin-bottom: 20px;\n  }\n\n  .button-container {\n    display: flex;\n    justify-content: center;\n\n    button {\n      font-size: inherit;\n\n      padding: 6px 20px 5px 20px;\n\n      border-radius: 2px;\n    }\n  }\n"]);return Oe=function(){return e},e}var je=s.a.section(Oe()),ye=function(){var e=Object(d.c)(P),n=Object(d.c)((function(e){return M(e)})),t=Object(a.useCallback)(e.map((function(e){return r.a.createElement(Ee,{key:e,itemId:e})})),[e]),c=Object(a.useCallback)((function(){return 0===e.length?r.a.createElement("span",null,"Your cart is empty"):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Total price: ",n,"$"),t,r.a.createElement("div",{className:"button-container"},r.a.createElement(o.b,{to:"/summary"},r.a.createElement("button",null,"Next"))))}),[e,t,n]);return r.a.createElement(je,null,c())};function ke(){var e=Object(l.a)(["\n  border: 1px solid black;\n  border-collapse: collapse;\n\n  th,\n  td {\n    border: 1px solid black;\n\n    padding: 5px 10px;\n\n    text-align: center;\n  }\n\n  td:first-child {\n    text-align: left;\n  }\n\n  th {\n    background-color: #e9e9e9;\n  }\n"]);return ke=function(){return e},e}function Ce(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n\n  h2,\n  h3 {\n    margin: 0;\n  }\n\n  .congratulations {\n    margin: 25px 0 30px 0;\n\n    text-align: center;\n\n    h3 {\n      margin-top: 5px;\n      font-weight: normal;\n    }\n  }\n\n  .total {\n    display: flex;\n    justify-content: space-around;\n\n    margin-top: 25px;\n\n    h3 span {\n      font-weight: normal;\n    }\n  }\n"]);return Ce=function(){return e},e}var we=s.a.article(Ce()),Ie=s.a.table(ke()),Ne=function(){var e=Object(d.b)(),n=Object(d.c)(I),t=Object(d.c)((function(e){return M(e)})),c=Object(d.c)((function(e){return V(e)}));Object(a.useEffect)((function(){return function(){e(ie(n)),e(T())}}),[e,n]);var i=Object(a.useCallback)(n.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.price),r.a.createElement("td",null,e.itemCount),r.a.createElement("td",null,e.price*e.itemCount))})),[n]);return r.a.createElement(we,null,r.a.createElement("section",{className:"congratulations"},r.a.createElement("h2",null,"Successful shopping!"),r.a.createElement("h3",null,"Thank you")),r.a.createElement("section",null,r.a.createElement(Ie,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Products"),r.a.createElement("th",null,"Price"),r.a.createElement("th",null,"Amount"),r.a.createElement("th",null,"Sum"))),r.a.createElement("tbody",null,i)),r.a.createElement("div",{className:"total"},r.a.createElement("h3",null,"Items: ",r.a.createElement("span",null,c," items")),r.a.createElement("h3",null,"Cost: ",r.a.createElement("span",null,t,"$")))))};function Pe(){var e=Object(l.a)(["\n  border: 1px solid black;\n  border-radius: 10px;\n\n  padding: 0 30px 30px 30px;\n\n  h3 {\n    text-align: center;\n  }\n\n  form {\n    display: flex;\n    flex-direction: column;\n\n    margin-top: 10px;\n\n    .input-block {\n      display: flex;\n      justify-content: flex-end;\n      align-items: center;\n\n      input {\n        width: 170px;\n\n        margin: 5px 0 10px 10px;\n        padding: 3px 0 3px 5px;\n\n        font-size: inherit;\n      }\n\n      label {\n        padding-bottom: 5px;\n      }\n    }\n\n    .buttons {\n      display: flex;\n      justify-content: space-around;\n\n      margin-top: 15px;\n\n      button {\n        width: 80px;\n        height: 30px;\n\n        border-radius: 10px;\n\n        font-size: inherit;\n      }\n    }\n  }\n"]);return Pe=function(){return e},e}var Ae=s.a.dialog(Pe()),Se=function(){var e=Object(d.b)(),n=Object(a.useCallback)((function(n){var t=n.target;if("BUTTON"===t.tagName){var a=n.currentTarget,r=a.elements;if("submit"===t.name){var c=[r.name.value,+r.price.value,+r.available.value];e(ce(c[0],c[1],c[2])),e(oe())}a.reset()}}),[e]);return r.a.createElement(Ae,{id:"modal"},r.a.createElement("h3",null,"Create New Product"),r.a.createElement("form",{method:"dialog",onClick:n},r.a.createElement("div",{className:"input-block"},r.a.createElement("label",null,"Name:"),r.a.createElement("input",{type:"text",name:"name",placeholder:"Apple iPhone",minLength:"2",maxLength:"60",autoComplete:"off"})),r.a.createElement("div",{className:"input-block"},r.a.createElement("label",null,"Price:"),r.a.createElement("input",{type:"number",name:"price",placeholder:"500",min:"0",max:"10000000",autoComplete:"off"})),r.a.createElement("div",{className:"input-block"},r.a.createElement("label",null,"Available:"),r.a.createElement("input",{type:"number",name:"available",placeholder:"40",min:"0",max:"100000",autoComplete:"off"})),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{name:"submit"},"Submit"),r.a.createElement("button",{name:"cancel"},"Cancel"))))};function Be(){var e=Object(l.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  margin-top: 10px;\n\n  button {\n    font-size: inherit;\n    padding: 3px 15px;\n    border-radius: 10px;\n  }\n\n  .all-in-cart {\n    padding-top: 3px;\n    font-style: italic;\n  }\n"]);return Be=function(){return e},e}function ze(){var e=Object(l.a)(["\n  padding: 15px 10px;\n  margin: 10px;\n\n  border: 1px solid black;\n\n  width: 150px;\n  height: 110px;\n\n  line-height: 1.4em;\n\n  h3 {\n    margin: 0 0 8px 0;\n  }\n\n  .in-stock {\n    color: #008000;\n  }\n\n  .few-in-stock {\n    color: #ddb059;\n  }\n\n  .out-of-stock {\n    color: red;\n  }\n"]);return ze=function(){return e},e}var Te=s.a.div(ze()),Ve=s.a.div(Be()),Me=function(e){var n=e.productId,t=Object(d.b)(),c=Object(d.c)((function(e){return be(e,n)})),i=Object(d.c)((function(e){return xe(e)})),l=Object(d.c)((function(e){return N(e,n)})),o=c.available,u=Object(a.useCallback)((function(){var e={id:c.id,name:c.name,price:c.price,itemCount:1};t(S(e))}),[t,c]),s=Object(a.useCallback)((function(){return o>0}),[o]),m=Object(a.useCallback)((function(){return l&&l.itemCount>=o?r.a.createElement("span",{className:"all-in-cart"},"all in cart"):r.a.createElement("button",{disabled:!s(),onClick:u},"add to cart")}),[l,o,u,s]),p=Object(a.useCallback)((function(){return o<5?r.a.createElement("span",{className:"few-in-stock"},"A few left"):r.a.createElement("span",{className:"in-stock"},"In stock")}),[o]),b=Object(a.useCallback)((function(){return s()?r.a.createElement("span",{title:"".concat(o," left")},p()):r.a.createElement("span",{className:"out-of-stock"},"Out of stock")}),[o,s,p]);return r.a.createElement(Te,{className:i||s()?"":"hidden"},r.a.createElement("h3",null,c.name),r.a.createElement("div",null,"Price: ",r.a.createElement("i",null,c.price)),r.a.createElement("div",null,b()),r.a.createElement(Ve,null,m()))};function $e(){var e=Object(l.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return $e=function(){return e},e}var Le=s.a.section($e()),Je=function(){var e=Object(d.b)(),n=Object(d.c)(fe),t=Object(d.c)((function(e){return e.products.status})),c=Object(d.c)((function(e){return e.products.error}));Object(a.useEffect)((function(){"idle"===t&&(e(ee()),e(oe()))}),[t,e]);var i=Object(a.useCallback)((function(){switch(t){case"loading":return r.a.createElement("div",null,"Loading...");case"succeeded":return n.map((function(e){return r.a.createElement(Me,{key:e,productId:e})}));case"failed":return r.a.createElement("div",null,c)}}),[t,n,c]);return r.a.createElement(Le,null,i())};function We(){var e=Object(l.a)(["\n  display: flex;\n  align-items: center;\n\n  margin: 15px 0 15px 10px;\n\n  select {\n    font-size: inherit;\n    font-family: inherit;\n\n    height: 30px;\n    width: 110px;\n\n    border-radius: 0;\n\n    &:focus {\n      outline: transparent;\n    }\n  }\n\n  button {\n    margin-left: 5px;\n    padding-bottom: 3px;\n\n    background-color: #e9e7e7;\n\n    font-size: inherit;\n\n    height: 30px;\n    width: 30px;\n\n    border: 1px solid black;\n  }\n\n  .checkbox-container {\n    display: flex;\n    align-items: center;\n\n    margin: 3px 0 0 25px;\n\n    input {\n      margin-right: 10px;\n    }\n  }\n"]);return We=function(){return e},e}var Fe=s.a.div(We()),Re=function(){var e=Object(d.b)(),n=Object(a.useState)(!0),t=Object(G.a)(n,2),c=t[0],i=t[1],l=Object(a.useCallback)((function(){e(de(!c)),e(ue()),i(!c)}),[e,c]),o=Object(a.useCallback)((function(n){e(se(n.target.value)),e(oe())}),[e]);return r.a.createElement(Fe,null,r.a.createElement("select",{onChange:o},r.a.createElement("option",{value:"name"},"Name"),r.a.createElement("option",{value:"price"},"Price"),r.a.createElement("option",{value:"availability"},"Available")),r.a.createElement("button",{onClick:l},c?"\u2191":"\u2193"),r.a.createElement("div",{className:"checkbox-container"},r.a.createElement("input",{type:"checkbox",onClick:function(){return e(le())}}),r.a.createElement("label",null,"Show non-available")))};function Ue(){var e=Object(l.a)(["\n  position: absolute;\n\n  display: flex;\n  flex-direction: column;\n\n  width: 100%;\n  height: 100%;\n\n  main {\n    display: flex;\n    flex-grow: 1;\n\n    article {\n      flex-grow: 1;\n      padding: 0 25px 0 20px;\n    }\n  }\n"]);return Ue=function(){return e},e}var Ye=s.a.div(Ue());var qe=function(){return r.a.createElement(o.a,{basename:"/"},r.a.createElement(Ye,null,r.a.createElement(Se,null),r.a.createElement(J,null),r.a.createElement("main",null,r.a.createElement(D,null),r.a.createElement("article",null,r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/"},r.a.createElement(Re,null),r.a.createElement(Je,null)),r.a.createElement(u.b,{exact:!0,path:"/cart"},r.a.createElement(ye,null)),r.a.createElement(u.b,{exact:!0,path:"/summary"},r.a.createElement(Ne,null)),r.a.createElement(u.a,{to:"/"}))))))},De=Object(m.a)({reducer:{products:me,navigation:g,cart:C}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d.a,{store:De},r.a.createElement(qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[44,1,2]]]);
//# sourceMappingURL=main.b81af52b.chunk.js.map